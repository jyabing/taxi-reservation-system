{% extends 'base.html' %}
{% load static %}
{% load custom_filters %}
{% block content %}

<h2>è½¦è¾†ä¸€å‘¨é¢„çº¦æ¦‚è§ˆ</h2>

<p>
  <a href="?offset={{ offset|add:"-1" }}">â† ä¸Šä¸€å‘¨</a> |
  <a href="?offset=0">æœ¬å‘¨</a> |
  <a href="?offset={{ offset|add:"1" }}">ä¸‹ä¸€å‘¨ â†’</a>
</p>

<table border="1">
  <thead>
    <tr>
      <th>è½¦ç‰Œå·</th>
      {% for date in week_dates %}
        <th>{{ date|date:"m/d (D)" }}</th>
      {% endfor %}
    </tr>
  </thead>
  <tbody>
    {% for row in vehicle_data %}
      <tr>
        {# æ­£ç¡®åŒ…è£¹è½¦ç‰Œå·çš„é“¾æ¥ #}
        <td>
          <a href="{% url 'vehicle_monthly_gantt' row.vehicle.id %}">
            {{ row.vehicle.license_plate }}
          </a>
        </td>
        {% for r in row.days %}
          <td style="color:
            {% if not r %}red
            {% elif r.status == 'reserved' %}blue
            {% elif r.status == 'out' %}orange
            {% elif r.status == 'canceled' %}gray
            {% else %}black
            {% endif %}
          ">
            {% if r %}
              <a href="{% url 'reservation_detail' r.id %}">
                {{ r.start_time }} - {{ r.end_time }}<br>{{ r.driver.username }}
              </a>
            {% else %}
              {# ä½¿ç”¨ custom_filters.index æ­£ç¡®å–å‡ºå½“å‰æ—¥æœŸ #}
              <a href="{% url 'make_reservation' row.vehicle.id %}
                        ?date={{ week_dates|index:forloop.counter0|date:"Y-m-d" }}">
                ğŸ“ ç©ºç¼º
              </a>
            {% endif %}
          </td>
        {% endfor %}
      </tr>
    {% endfor %}
  </tbody>
</table>

<p><a href="{% url 'vehicle_status' %}">â† è¿”å›çŠ¶æ€é¡µ</a></p>
{% endblock %}
