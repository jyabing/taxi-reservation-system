{% extends 'base.html' %}
{% load static %}
{% block content %}

{% include 'vehicles/status_tab_navigation.html' %}  {# æ’å…¥ Tab æŒ‰é’® #}

<h2>è½¦è¾†é¢„çº¦çŠ¶æ€ä¸€è§ˆ({{ selected_date }})</h2>

<form method="get">
    é€‰æ‹©æ—¥æœŸï¼š<input type="date" name="date" value="{{ selected_date }}">
    <button type="submit">æŸ¥è¯¢</button>
</form>

<table border="1">
<tr>
    <th>è½¦ç‰Œå·</th><th>è½¦å‹</th><th>çŠ¶æ€</th>
</tr>
{% for vehicle, info in status_map.items %}
<tr>
  <td><a href="{% url 'vehicle_detail' vehicle.id %}">{{ vehicle.license_plate }}</a></td>
  <td>{{ vehicle.model }}</td>
  <td style="color:
  {% if info.status == 'available' %}red
  {% elif info.status == 'reserved' %}blue
  {% elif info.status == 'out' %}orange
  {% elif info.status == 'canceled' %}gray
  {% endif %}
">
  {% if info.status == 'available' %}
    <a href="{% url 'make_reservation' vehicle.id %}?date={{ selected_date }}">
      ğŸŸ¥ ç©ºç¼ºï¼ˆç‚¹æ­¤é¢„çº¦ï¼‰
    </a>
  {% else %}
    {{ vehicle.get_status_display }}

    {% if info.status == 'reserved' and info.user_reservation %}
      {% if not info.user_reservation.actual_departure %}
        <br><a href="{% url 'check_out' info.user_reservation.id %}">ğŸš— å‡ºåº“</a>
      {% elif not info.user_reservation.actual_return %}
        <br><a href="{% url 'check_in' info.user_reservation.id %}">ğŸ…¿ï¸ è¿˜è½¦</a>
      {% else %}
        <br>âœ… å·²å®Œæˆå‡ºå…¥åº“
      {% endif %}
    {% endif %}
  {% endif %}
</td>
</tr>
{% endfor %}
</table>
{% endblock %}