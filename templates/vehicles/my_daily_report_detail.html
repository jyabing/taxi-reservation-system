{% extends 'base.html' %}
{% load time_filters %}
{% block content %}
<h4 class="mb-4">ğŸ“ {{ report.date }} æ—¥æŠ¥è¯¦æƒ…</h4>

<!-- å¤‡æ³¨åŒº -->
<div class="alert alert-warning small rounded shadow-sm">
  <strong>å¤‡æ³¨ï¼š</strong>{{ report.note|default:"æ— " }}
</div>

<!-- è½¦è¾†å¡ç‰‡ + å‡ºé€€å‹¤å¡ç‰‡åŒºåŸŸ -->
<div class="d-flex flex-wrap gap-3 my-4">
  <div class="card border-start border-4 border-dark shadow-sm" style="min-width: 160px;">
    <div class="card-body py-2 px-3">
      <div class="small text-muted">æœ¬æ—¥ä½¿ç”¨è½¦è¾†</div>
      <div class="fw-bold">
        {{ report.vehicle|default:"æœªé€‰æ‹©" }}
      </div>
    </div>
  </div>

<!-- å‡ºé€€å‹¤å¡ç‰‡åŒºåŸŸ -->
<div class="d-flex flex-wrap gap-3 my-4">
  <div class="card border-start border-4 border-primary shadow-sm" style="min-width: 160px;">
    <div class="card-body py-2 px-3">
      <div class="small text-muted">å‡ºå‹¤æ™‚é–“</div>
      <div class="fw-bold">{{ start_time|time:'H:i'|default:"--:--" }}</div>
    </div>
  </div>
  <!-- é€€å‹¤ -->
  <div class="card border-start border-4 border-danger shadow-sm" style="min-width: 160px;">
    <div class="card-body py-2 px-3">
      <div class="small text-muted">é€€å‹¤æ™‚é–“</div>
      <div class="fw-bold">{{ end_time|time:'H:i'|default:"--:--" }}</div>
    </div>
  </div>
  <!-- æ²¹é‡ -->
  <div class="card border-start border-4 border-success shadow-sm" style="min-width: 160px;">
    <div class="card-body py-2 px-3">
      <div class="small text-muted">ç·æ™‚é•·</div>
      <div class="fw-bold text-primary">{{ duration|time_length|default:"--:--" }}</div>
    </div>
  </div>
  <!-- é‡Œç¨‹ -->
  <div class="card border-start border-4 border-warning shadow-sm" style="min-width: 160px;">
    <div class="card-body py-2 px-3">
      <div class="small text-muted">æ²¹é‡ (L)</div>
      <div class="fw-bold">{{ report.gas_volume|default:"--" }}</div>
    </div>
  </div>
  <div class="card border-start border-4 border-info shadow-sm" style="min-width: 160px;">
    <div class="card-body py-2 px-3">
      <div class="small text-muted">é‡Œç¨‹ (KM)</div>
      <div class="fw-bold">{{ report.mileage|default:"--" }}</div>
    </div>
  </div>
</div>

<!-- æ˜ç»†è¡¨ -->
{% if report.items.all %}
<div class="card shadow-sm mt-4">
  <div class="card-body p-0">
    <table class="table table-bordered table-sm mb-0">
      <thead class="table-light">
        <tr>
          <th>æ—¶é—´</th>
          <th>èµ·ç‚¹</th>
          <th>é‡‘é¢</th>
          <th>æ”¯ä»˜æ–¹å¼</th>
          <th>æ³¨é‡Š</th>
        </tr>
      </thead>
      <tbody>
        {% for item in report.items.all %}
        <tr class="{% if item.note or item.is_flagged %}table-warning{% endif %}">
          <td>{{ item.ride_time }}</td>
          <td>{{ item.ride_from }}</td>
          <td>{{ item.meter_fee }}</td>
          <td>{{ item.get_payment_method_display }}</td>
          <td>
            {{ item.note|default:"" }}
            {% if item.note %}<span title="æœ‰æ³¨é‡Š">ğŸ“</span>{% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% else %}
<div class="text-muted mt-3">æ— è¡Œç¨‹æ˜ç»†</div>
{% endif %}

<p class="mt-4">
  <a href="{% url 'my_dailyreports' %}" class="btn btn-outline-secondary btn-sm">â† è¿”å›æ—¥æŠ¥åˆ—è¡¨</a>
</p>
{% endblock %}