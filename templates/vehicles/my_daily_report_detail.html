{% extends 'base.html' %}
{% load time_filters %}
{% block content %}
<h2>📝 {{ report.date }} 日报详细</h2>
<h3>备注：{{ report.note|default:"无" }}</h3>

<!-- 只读元数据展示区 -->
  <div class="row g-3 mb-4 align-items-end">
  <!-- 出勤時間 -->
  <div class="col-auto">
    <label class="form-label d-block">出勤時間</label>  {{ start_time|date:"Y年n月j日 H:i" }}
  </div>

  <!-- 退勤時間 -->
  <div class="col-auto">
    <label class="form-label d-block">退勤時間</label> {{ end_time|date:"Y年n月j日 H:i" }}
  </div>

  <!-- 総時長 -->
  <div class="col-auto">
    <label class="form-label d-block">総時長：</label>
    <div>{{ duration|time_length }}</div>
  </div>

  <!-- ガソリン量 -->
  <div class="col-auto ms-auto">
    <label class="form-label d-block">ガソリン量 (L)</label>{{ report.gas_volume }} L
  </div>

  <!-- 里程 -->
  <div class="col-auto">
    <label class="form-label d-block">里程 (KM)</label> {{ report.mileage }} KM
  </div>
</div>


{% if report.items.all %}
  <table border="1" style="width:100%;margin-bottom:1.5em;">
    <thead>
      <tr>
        <th>时间</th>
        <th>起点</th>
        <th>终点</th>
        <th>男</th>
        <th>女</th>
        <th>金额</th>
        <th>支付方式</th>
        <th>注释</th>
      </tr>
    </thead>
    <tbody>
      {% for item in report.items.all %}
      <tr {% if item.note %} style="background:#fff9c4" {% endif %}>
        <td>{{ item.ride_time }}</td>
        <td>{{ item.ride_from }}</td>
        <td>{{ item.ride_to }}</td>
        <td>{{ item.num_male }}</td>
        <td>{{ item.num_female }}</td>
        <td>{{ item.meter_fee }}</td>
        <td>{{ item.get_payment_method_display }}</td>
        <td>
            {{ item.note|default:"" }}
            {% if item.note %}<span title="有注释">📝</span>{% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% else %}
  <div style="color:#888;">无行程明细</div>
{% endif %}

<p><a href="{% url 'my_daily_reports' %}">← 返回日报明细列表</a></p>
{% endblock %}