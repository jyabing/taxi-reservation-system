{% extends "staffbook/base_staffbook.html" %}
{% block content %}

<style>
  .staff-detail-box {
    max-width: 540px;
    margin: 2em auto;
    background: #fff;
    border-radius: 1em;
    padding: 2em 1.5em 1.5em 1.5em;
    box-shadow: 0 2px 16px #f0f2f7;
  }
  .staff-detail-box h3 {
    margin-bottom: 0.7em;
    font-size: 1.3em;
    letter-spacing: .03em;
  }
  .staff-detail-box ul {
    margin-bottom: 1.2em;
    color: #666;
    font-size: 1.06em;
  }
  .dailyreport-card {
    background: #f8fafd;
    border-radius: 0.7em;
    padding: 1.1em 1em 1em 1em;
    margin-bottom: 1.2em;
    box-shadow: 0 2px 8px #f2f6fa;
  }
  .action-btn {
    display: inline-block;
    background: #1677ff;
    color: #fff;
    padding: 0.42em 1.3em;
    border-radius: 2em;
    border: none;
    margin: 0.1em 0.4em 0.5em 0;
    text-decoration: none;
    font-size: 1em;
    transition: background 0.17s;
  }
  .action-btn:hover { background: #4093ff; }
  .link-btn {
    color: #1677ff;
    margin-left: 1.1em;
    text-decoration: underline;
  }
  .date-input {
    padding: 0.4em 1.2em;
    border-radius: 1.7em;
    border: 1px solid #ccc;
    margin: 0 0.5em;
    font-size: 1.03em;
  }
</style>

<div class="staff-detail-box">
  <h3>{{ driver.name }}（{{ driver.staff_code }}）</h3>
  <ul>
    <li>手机号: {{ driver.phone|default:"无" }}</li>
    <li>税号: {{ driver.tax_id|default:"无" }}</li>
  </ul>

  <!-- 日报检索 -->
  <form method="get" style="margin-bottom:1em;">
    <label>选择日期：</label>
    <input type="date" name="date" value="{{ selected_date|default:'' }}">
    <button type="submit" class="btn btn-outline-secondary">查日报</button>
  </form>

  {% if dailyreport %}
    <div style="background:#f9f9f9;border-radius:0.7em;padding:1em;margin-bottom:1em;">
      <b>{{ dailyreport.date }}</b> 日报<br>
      <div>{{ dailyreport.note|linebreaks }}</div>
      <a href="{% url 'staffbook:driver_dailyreport_edit' driver.id dailyreport.id %}" class="btn btn-sm btn-outline-primary">编辑</a>
      <a href="{% url 'staffbook:driver_dailyreport_delete' driver.id dailyreport.id %}" class="btn btn-sm btn-outline-danger">删除</a>
    </div>
  {% elif selected_date %}
    <div style="color:#888;">
      {{ selected_date }} 暂无日报，
      <a href="{% url 'staffbook:driver_dailyreport_add' driver.id %}?date={{ selected_date }}">新增日报</a>
    </div>
  {% endif %}

  <!-- 总是显示新增日报按钮 -->
  <div style="margin:1.3em 0 0.5em 0;">
    <a href="{% url 'staffbook:driver_dailyreport_add' driver.id %}" class="action-btn">➕ 新增日报</a>
    <a href="{% url 'staffbook:driver_edit' driver.id %}" class="link-btn">编辑员工信息</a>
    <a href="{% url 'staffbook:driver_list' %}" class="link-btn">返回员工列表</a>
  </div>
</div>
{% endblock %}
