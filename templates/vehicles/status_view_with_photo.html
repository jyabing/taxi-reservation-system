{% extends 'base.html' %}
{% load static %}
{% block content %}

{% include 'vehicles/status_tab_navigation.html' %}  {# æ’å…¥ Tab æŒ‰é’® #}

<h2>ğŸš˜ è½¦è¾†é¢„çº¦çŠ¶æ€ä¸€è§ˆï¼ˆ{{ selected_date }}ï¼‰</h2>

<form method="get">
  é€‰æ‹©æ—¥æœŸï¼š<input type="date" name="date" value="{{ selected_date }}">
  <button type="submit">æŸ¥è¯¢</button>
</form>

<table border="1">
  <tr>
    <th>è½¦è¾†</th><th>çŠ¶æ€</th><th>æ“ä½œ</th>
  </tr>
  {% for vehicle, info in status_map.items %}
  <tr>
    <td>
      <strong>{{ vehicle.license_plate }}</strong><br>
      <span style="color:gray;">{{ vehicle.model }}</span><br>
      {% if vehicle.photo %}
        <img src="{{ vehicle.photo.url }}" width="120" style="margin-top:5px; border:1px solid #ccc;"><br>
      {% else %}
        <span style="color:gray;">æ— ç…§ç‰‡</span>
      {% endif %}
    </td>
    <td style="color:
      {% if info.status == 'available' %}red
      {% elif info.status == 'reserved' %}blue
      {% elif info.status == 'out' %}orange
      {% elif info.status == 'canceled' %}gray
      {% endif %}
    ">
      {{ info.status|title }}
    </td>
    <td>
      {% if info.status == 'available' %}
        <a href="{% url 'make_reservation' vehicle.id %}?date={{ selected_date }}">ğŸ“ ç”³è¯·é¢„çº¦</a>
      {% elif info.user_reservation %}
        {% if not info.user_reservation.actual_departure %}
          <a href="{% url 'check_out' info.user_reservation.id %}">ğŸš— å‡ºåº“</a>
        {% elif not info.user_reservation.actual_return %}
          <a href="{% url 'check_in' info.user_reservation.id %}">ğŸ…¿ï¸ å…¥åº“</a>
        {% else %}
          âœ… å·²å®Œæˆ
        {% endif %}
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>

{% endblock %}