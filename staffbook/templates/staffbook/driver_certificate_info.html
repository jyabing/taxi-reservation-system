{% extends "staffbook/base_staffbook.html" %}
{% block content %}

<div class="container mt-4">
  <div class="card shadow" style="width:90vw;max-width:1400px;margin:0 auto;">
    <div class="card-header bg-white d-flex align-items-center" style="font-size:1.3em;">
        <i class="fa fa-user me-2"></i>
        <b>{{ driver.name }}</b>
        <span class="badge bg-primary ms-2" style="font-size:0.9em;">No.{{ driver.driver_code }}</span>
        <span class="ms-auto" style="font-size:0.95em;">
            äº‹æ¥­è€…å: {{ driver.company.name|default_if_none:""|default:"-" }}ã€€å–¶æ¥­æ‰€å: {{ driver.workplace.name|default_if_none:""|default:"-" }}
        </span>
    </div>
    <div class="card-body">
      {% include "staffbook/driver_tab_nav.html" %}

      <div class="d-flex justify-content-between mt-3 mb-2">
        <h4>ğŸ›‚ åœ¨ç•™è³‡æ ¼ãƒ»ç­¾è¯æƒ…å ±</h4>
        <a href="{% url 'staffbook:driver_certificate_edit' driver.id %}" class="btn btn-outline-primary btn-sm">
          <i class="fa fa-edit"></i> ç·¨é›†
        </a>
      </div>

      <table class="table table-bordered">
        <tr><th style="width:180px;">å¤–å›½ç±</th><td>{{ driver.is_foreign|yesno:"âœ… æ˜¯,âŒ å¦" }}</td></tr>
        <tr><th>å›½ç±</th><td>{{ driver.nationality }}</td></tr>
        <tr><th>åœ¨ç•™è³‡æ ¼</th><td>{{ driver.residence_status }}</td></tr>
        <tr><th>åœ¨ç•™æœŸé™</th>
            <td>
              {% if driver.residence_expiry %}
                {% if driver.residence_expiry|date:"Y-m-d" <= today|date:"Y-m-d"|add:"30" %}
                  <span class="text-danger fw-bold">{{ driver.residence_expiry }}</span> â°
                {% else %}
                  {{ driver.residence_expiry }}
                {% endif %}
              {% else %}
                æœªè¨­å®š
              {% endif %}
            </td>
        </tr>
        <tr><th>åœ¨ç•™ã‚«ãƒ¼ãƒ‰</th>
            <td>
              {% if driver.residence_card_image %}
                <a href="{{ driver.residence_card_image.url }}" target="_blank">ğŸ“ é–²è¦§ã™ã‚‹</a>
              {% else %}
                âŒ æœªä¸Šä¼ 
              {% endif %}
            </td>
        </tr>
        <tr><th>å°±åŠ´è³‡æ ¼ç¢ºèª</th><td>{{ driver.work_permission_confirmed|yesno:"âœ… æ¸ˆ,âŒ æœªç¢ºèª" }}</td></tr>
      </table>

      <h5 class="mt-4">ğŸ“ å…¥ç¤¾è³‡æ–™æå‡ºçŠ¶æ³</h5>
      <table class="table table-sm table-striped">
        <tr><th style="width:200px;">å¥åº·è¨ºæ–­æ›¸</th><td>{{ driver.has_health_check|yesno:"âœ… æ¸ˆ,âŒ æœªæå‡º" }}</td></tr>
        <tr><th>ä½æ°‘ç¥¨</th><td>{{ driver.has_residence_certificate|yesno:"âœ… æ¸ˆ,âŒ æœªæå‡º" }}</td></tr>
        <tr><th>æ‰¶é¤Šæ§é™¤ç­‰ç”³å‘Šæ›¸</th><td>{{ driver.has_tax_form|yesno:"âœ… æ¸ˆ,âŒ æœªæå‡º" }}</td></tr>
        <tr><th>å…è¨±è¨¼ã‚³ãƒ”ãƒ¼</th><td>{{ driver.has_license_copy|yesno:"âœ… æ¸ˆ,âŒ æœªæå‡º" }}</td></tr>
      </table>
    </div>
  </div>
</div>
{% endblock %}
