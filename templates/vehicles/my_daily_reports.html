{% extends 'base.html' %}
{% load dict_filters %}
{% block content %}

<h2>📅 {{ month_display }} 日报明细</h2>
<form method="get" style="margin-bottom:1em;">
    <label>按日期：</label>
    <input type="date" name="date" value="{{ selected_date|default:'' }}">
    <label style="margin-left:1.2em;">按月份：</label>
    <input type="month" name="month" value="{{ selected_month|default:'' }}">
    <button type="submit" class="btn btn-outline-secondary">查日报</button>
    {% if selected_date or selected_month %}
        <a href="{% url 'my_daily_reports' %}" style="margin-left:1.2em;">重置</a>
    {% endif %}
</form>

{% if reports %}
<table border="1" style="width:100%;margin-bottom:1.5em;">
    <thead>
    <tr>
        <th>日期</th>
        <th>メータ料金合计</th>
        <th>操作</th>
        <th>备注</th>
    </tr>
    </thead>
    <tbody>
    {% for report in reports %}
    <tr>
        <td>{{ report.date }}</td>
        <td>{{ report_sums|get_item:report.id|default:"0" }}</td>
        <td>
            <a href="{% url 'my_daily_report_detail' report.id %}">查看明细</a>
        </td>
        <td>{{ report.note|default:"无" }}</td>
    </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
    <div style="color:#888;">没有查到日报。</div>
{% endif %}

<div style="margin-top:1em; font-weight:bold;">
    本期メータ料金合计：{{ total_meter_fee|default:"0" }} 円
</div>

<p><a href="{% url 'profile' %}">← 返回我的资料</a></p>
{% endblock %}
